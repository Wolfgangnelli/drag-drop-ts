(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}function n(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}var r;!function(e){e[e.Acitve=0]="Acitve",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Acitve);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const l=i.getInstance();class o extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value.charAt(0).toUpperCase()+this.titleInputElement.value.substring(1),t=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:t,required:!0,minLength:5},i={value:+r,required:!0,min:1,max:5};return n({value:e,required:!0})&&n(s)&&n(i)?[e,t,+r]:void alert("Invalid input, please try again!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;l.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([t],o.prototype,"submitHandler",null);var a=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class c extends e{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+"assigned",this.element.querySelector("p").textContent=this.project.description}}a([t],c.prototype,"dragStartHandler",null),a([t],c.prototype,"dragEndHandler",null);var d=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class p extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.element.id=`${this.type}-projects`,this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");l.moveProject(t,"active"===this.type?r.Acitve:r.Finished)}dragLeaveHandler(e){const t=this.element.querySelector("ul");null==t||t.classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("drop",this.dropHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),l.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Acitve:e.status===r.Finished));this.assignedProjects=t,this.renderProject()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+"PROJECTS"}renderProject(){const e=document.getElementById(`${this.type}-projects-list`);e.innerHTML="";for(const t of this.assignedProjects)new c(e.id,t)}}d([t],p.prototype,"dragOverHandler",null),d([t],p.prototype,"dropHandler",null),d([t],p.prototype,"dragLeaveHandler",null),new o,new p("active"),new p("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQ2IsTUFBTWlHLEVBQVNoSCxLQUFLUSxRQUFRMEQsY0FBYyxNQUMxQzhDLE1BQUFBLEdBQUFBLEVBQVFOLFVBQVVPLE9BQU8sYUFJN0I1QyxZQUNJckUsS0FBS1EsUUFBUThELGlCQUFpQixXQUFZdEUsS0FBS3dHLGlCQUMvQ3hHLEtBQUtRLFFBQVE4RCxpQkFBaUIsT0FBUXRFLEtBQUs0RyxhQUMzQzVHLEtBQUtRLFFBQVE4RCxpQkFBaUIsWUFBYXRFLEtBQUsrRyxrQkFFaERqRCxFQUFhcEIsYUFBYUksSUFFdEIsTUFBTW9FLEVBQWtCcEUsRUFBU3FFLFFBQU9DLEdBQ25CLFdBQWRwSCxLQUFLc0csS0FDR2MsRUFBSzdFLFNBQVdMLEVBQWNtQixPQUU5QitELEVBQUs3RSxTQUFXTCxFQUFjNEUsV0FFN0M5RyxLQUFLdUcsaUJBQW1CVyxFQUN4QmxILEtBQUtxSCxtQkFLWjdDLGdCQUNHLE1BQU04QyxFQUFTLEdBQUd0SCxLQUFLc0cscUJBQ3ZCdEcsS0FBS1EsUUFBUTBELGNBQWMsTUFBT3hELEdBQUs0RyxFQUN2Q3RILEtBQUtRLFFBQVEwRCxjQUFjLE1BQU9pQyxZQUFjbkcsS0FBS3NHLEtBQUsxQixjQUFnQixXQUl0RXlDLGdCQUNKLE1BQU1MLEVBQVM5RyxTQUFTQyxlQUFlLEdBQUdILEtBQUtzRyxzQkFFL0NVLEVBQU9PLFVBQVksR0FDbkIsSUFBSyxNQUFNQyxLQUFXeEgsS0FBS3VHLGlCQUN2QixJQUFJYixFQUFZc0IsRUFBT3RHLEdBQUk4RyxJQXJEbkMsR0FEQzFHLEcsb0NBVUQsR0FEQ0EsRyxnQ0FRRCxHQURDQSxHLHFDQ3JDTCxJQUFJa0QsRUFDSixJQUFJcUMsRUFBWSxVQUNoQixJQUFJQSxFQUFZLGEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmFnLWRyb3B0c3Byb2plY3QvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3B0c3Byb2plY3QvLi9zcmMvZGVjb3JhdG9ycy9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3B0c3Byb2plY3QvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL2RyYWctZHJvcHRzcHJvamVjdC8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3B0c3Byb2plY3QvLi9zcmMvc3RhdGUvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3B0c3Byb2plY3QvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL2RyYWctZHJvcHRzcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3B0c3Byb2plY3QvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wdHNwcm9qZWN0Ly4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ29tcG9uZW50IEJhc2UgQ2xhc3MgLSBHZW5lcmljIGNsYXNzXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcclxuICAgIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgIGhvc3RFbGVtZW50OiBUO1xyXG4gICAgZWxlbWVudDogVTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZUlkOiBzdHJpbmcsIGhvc3RFbGVtZW50SWQ6IHN0cmluZywgaW5zZXJ0QXRTdGFydDogYm9vbGVhbiwgbmV3RWxlbWVudElkPzogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZUlkKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50ID0gPFQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkhO1xyXG5cclxuICAgICAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGltcG9ydGVkTm9kZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBVO1xyXG4gICAgICAgIGlmKG5ld0VsZW1lbnRJZCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdEJlZ2lubmluZzogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KGluc2VydEF0QmVnaW5uaW5nID8gJ2FmdGVyYmVnaW4nIDogJ2JlZm9yZWVuZCcsIHRoaXMuZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICBhYnN0cmFjdCBjb25maWd1cmUoKTogdm9pZDtcclxuXHJcbiAgIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcclxufVxyXG5cclxuIiwiLyoqXHJcbiAqIEF1dG9iaW5kIGRlY29yYXRvciBtZXRob2RcclxuICovXHJcbiBleHBvcnQgZnVuY3Rpb24gQXV0b2JpbmQoXzogYW55LCBfMjogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcclxuICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcclxuICAgIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgICBjb25zdCBib3VuZEZ1biA9IG9yaWdpbmFsTWV0aG9kLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBib3VuZEZ1bjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYWRqRGVzY3JpcHRvcjtcclxufVxyXG5cclxuIiwiXHJcbi8qKlxyXG4gKiBWYWxpZGF0aW9uXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxlIHtcclxuICAgIHZhbHVlOiBzdHJpbmcgfCBudW1iZXI7XHJcbiAgICByZXF1aXJlZD86IGJvb2xlYW47XHJcbiAgICBtaW5MZW5ndGg/OiBudW1iZXI7XHJcbiAgICBtYXhMZW5ndGg/OiBudW1iZXI7XHJcbiAgICBtaW4/OiBudW1iZXI7XHJcbiAgICBtYXg/OiBudW1iZXI7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQ6IFZhbGlkYXRhYmxlKTogYm9vbGVhbiB7XHJcbiAgICBsZXQgaXNWYWxpZCA9IHRydWU7XHJcbiAgICBpZih2YWxpZGF0YWJsZUlucHV0LnJlcXVpcmVkKSB7ICAgICAgXHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggIT09IDA7XHJcbiAgICB9XHJcbiAgICBpZih2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoID49IHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgaWYodmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcclxuICAgIH1cclxuICAgIGlmKHZhbGlkYXRhYmxlSW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA+PSB2YWxpZGF0YWJsZUlucHV0Lm1pbjtcclxuICAgIH1cclxuICAgIGlmKHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heDtcclxuICAgIH1cclxuICAgIHJldHVybiBpc1ZhbGlkO1xyXG59XHJcblxyXG4iLCJcclxuZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7QWNpdHZlLCBGaW5pc2hlZH07XHJcblxyXG4vKipcclxuICogUHJvamVjdCBUeXBlIFxyXG4gKi9cclxuIGV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBpZDogc3RyaW5nLCBwdWJsaWMgdGl0bGU6IHN0cmluZywgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHB1YmxpYyBwZW9wbGU6IG51bWJlciwgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1cykge31cclxufVxyXG5cclxuIiwiaW1wb3J0IHtQcm9qZWN0LCBQcm9qZWN0U3RhdHVzfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcblxyXG5cclxuLy8gR2VuZXJpYyB0eXBlIExpc3RlbmVyXHJcbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcclxuXHJcbi8qKlxyXG4gKiBTdGF0ZSBCYXNlIENsYXNzXHJcbiAqL1xyXG5hYnN0cmFjdCBjbGFzcyBTdGF0ZTxUPiB7XHJcbiAgICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107IC8vYXJyYXkgb2YgZnVuY3Rpb24sIGZuIHJlZmVyZW5jZXNcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlZ2lzdGVyIGEgbGlzdGVuZXIgZnVuY3Rpb25cclxuICAgICAqIEBwYXJhbSBsaXN0ZW5lckZuIFxyXG4gICAgICovXHJcbiAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lckZuOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbik7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4vKipcclxuICogUHJvamVjdCBTdGF0ZSBNYW5hZ2VtZW50IGNsYXNzIC0gU2luZ2xldG9uIGNsYXNzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGU8UHJvamVjdD4ge1xyXG4gICAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XHJcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xyXG5cclxuICAgIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgIHN1cGVyKCk7XHJcbiAgICAgfVxyXG5cclxuICAgIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcclxuICAgICAgICBpZih0aGlzLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluc3RhbmNlID0gbmV3IFByb2plY3RTdGF0ZSgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZFByb2plY3QodGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgbnVtT2ZQZW9wbGU6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcclxuICAgICAgICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICB0aXRsZSxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgIG51bU9mUGVvcGxlLFxyXG4gICAgICAgICAgICBQcm9qZWN0U3RhdHVzLkFjaXR2ZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIG1vdmVQcm9qZWN0KHByaklkOiBzdHJpbmcsIG5ld1N0YXR1czogUHJvamVjdFN0YXR1cykge1xyXG4gICAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHByaiA9PiBwcmouaWQgPT09IHByaklkKTtcclxuICAgICAgaWYocHJvamVjdCAmJiBwcm9qZWN0LnN0YXR1cyAhPT0gbmV3U3RhdHVzKSB7XHJcbiAgICAgICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcclxuICAgICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgICAgIH0gICBcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVycygpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyRm4gb2YgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vLyBHbG9iYWwgY29uc3RhbnQgc2luZ2xldG9uIGluc3RhbmNlIG9mIHByb2plY3Qgc3RhdGVcclxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpO1xyXG4iLCJpbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xyXG5pbXBvcnQge0F1dG9iaW5kfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJztcclxuaW1wb3J0ICogYXMgVmFsaWRhdGlvbiBmcm9tICcuLi91dGlsL3ZhbGlkYXRpb24nO1xyXG5pbXBvcnQge3Byb2plY3RTdGF0ZX0gZnJvbSAnLi4vc3RhdGUvcHJvamVjdCc7XHJcblxyXG4vKipcclxuICogUHJvamVjdElucHV0IGNsYXNzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcclxuICAgIHRpdGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKTtcclxuXHJcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjcGVvcGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJDb250ZW50KCkge307XHJcblxyXG4gIFxyXG4gICAgcHJpdmF0ZSBnYXRoZXJVc2VySW5wdXQoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdm9pZCB7XHJcbiAgICAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZS5zdWJzdHJpbmcoMSk7XHJcbiAgICAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xyXG4gICAgICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xyXG5cclxuICAgICAgIGNvbnN0IHRpdGxlVmFsaWRhdGFibGU6IFZhbGlkYXRpb24uVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgICAgdmFsdWU6IGVudGVyZWRUaXRsZSxcclxuICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgICAgfVxyXG4gICAgICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcclxuICAgICAgICB2YWx1ZTogZW50ZXJlZERlc2NyaXB0aW9uLFxyXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgIG1pbkxlbmd0aDogNVxyXG4gICAgfVxyXG4gICAgY29uc3QgcGVvcGxlVmFsaWRhdGFibGU6IFZhbGlkYXRpb24uVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgdmFsdWU6ICtlbnRlcmVkUGVvcGxlLFxyXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgIG1pbjogMSxcclxuICAgICAgICBtYXg6IDVcclxuICAgIH1cclxuXHJcbiAgICAgICAvLyBjaGVjayB2YWxpZGF0aW9uXHJcbiAgICAgICBpZighVmFsaWRhdGlvbi52YWxpZGF0ZSh0aXRsZVZhbGlkYXRhYmxlKSB8fCAhVmFsaWRhdGlvbi52YWxpZGF0ZShkZXNjcmlwdGlvblZhbGlkYXRhYmxlKSB8fCAhVmFsaWRhdGlvbi52YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSkpIHtcclxuICAgICAgICAgICBhbGVydCgnSW52YWxpZCBpbnB1dCwgcGxlYXNlIHRyeSBhZ2FpbiEnKTtcclxuICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgIGVudGVyZWRUaXRsZSxcclxuICAgICAgICAgICAgICAgZW50ZXJlZERlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICAgICArZW50ZXJlZFBlb3BsZVxyXG4gICAgICAgICAgIF07XHJcbiAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gXCJcIjtcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gXCJcIjtcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUpO1xyXG4gICAgICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcclxuICAgICAgIGlmKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICAgICAgIGNvbnN0IFt0aXRsZSwgZGVzYywgcGVvcGxlXSA9IHVzZXJJbnB1dDtcclxuICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xyXG4gICAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xyXG4gICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKTtcclxuICAgICAgIH1cclxuICAgIH1cclxuXHJcbn1cclxuIiwiaW1wb3J0IHtEcmFnZ2FibGV9IGZyb20gJy4uL21vZGVscy9kcmFnLWRyb3AnO1xyXG5pbXBvcnQge1Byb2plY3R9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0JztcclxuaW1wb3J0IENvbXBvbmVudCBmcm9tICcuL2Jhc2UtY29tcG9uZW50JztcclxuaW1wb3J0IHtBdXRvYmluZH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcblxyXG5cclxuLyoqXHJcbiAqIFByb2plY3QgSXRlbSBDbGFzc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ2dhYmxlIHtcclxuICAgIHByaXZhdGUgcHJvamVjdDogUHJvamVjdDtcclxuXHJcbiAgICAvLyBHZXR0ZXIgKGNhbGwgaXQgbGlrZSBhIHByb3ApXHJcbiAgICBnZXQgcGVyc29ucygpIHtcclxuICAgICAgICBpZih0aGlzLnByb2plY3QucGVvcGxlID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIjEgcGVyc29uXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xyXG4gICAgICAgIHN1cGVyKCdzaW5nbGUtcHJvamVjdCcsIGhvc3RJZCwgZmFsc2UsIHByb2plY3QuaWQpO1xyXG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpO1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJztcclxuICAgIH1cclxuXHJcbiAgICBAQXV0b2JpbmRcclxuICAgIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdEcmFnRW5kJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcik7XHJcbiAgICB9O1xyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJ2Fzc2lnbmVkJztcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvbjtcclxuICAgIH07XHJcbiAgXHJcbn1cclxuIiwiaW1wb3J0IHtQcm9qZWN0LCBQcm9qZWN0U3RhdHVzfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7RHJhZ1RhcmdldH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCc7XHJcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7cHJvamVjdFN0YXRlfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0JztcclxuaW1wb3J0IHtBdXRvYmluZH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbmltcG9ydCB7UHJvamVjdEl0ZW19IGZyb20gJy4vcHJvamVjdC1pdGVtJztcclxuXHJcblxyXG4vKipcclxuICogUHJvamVjdCBMaXN0IENsYXNzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xyXG4gICAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKSB7XHJcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtbGlzdCcsICdhcHAnLCBmYWxzZSwgYCR7dHlwZX0tcHJvamVjdHNgKTtcclxuICBcclxuICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0c2A7XHJcbiAgIFxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGlmKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJykge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XHJcbiAgICAgICAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgcHJqSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcclxuICAgICAgICBwcm9qZWN0U3RhdGUubW92ZVByb2plY3QocHJqSWQsIHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScgPyBQcm9qZWN0U3RhdHVzLkFjaXR2ZSA6IFByb2plY3RTdGF0dXMuRmluaXNoZWQpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBAQXV0b2JpbmRcclxuICAgIGRyYWdMZWF2ZUhhbmRsZXIoXzogRHJhZ0V2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJyk7XHJcbiAgICAgICAgbGlzdEVsPy5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xyXG5cclxuICAgICAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcclxuICAgICAgICAgICAgLy9maWx0ZXJpbmcgcHJvamVjdHNcclxuICAgICAgICAgICAgY29uc3QgcmVsZXZhbnRQcm9qZWN0ID0gcHJvamVjdHMuZmlsdGVyKHByb2ogPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy50eXBlID09PSAnYWN0aXZlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9qLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5BY2l0dmU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2ouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcmVsZXZhbnRQcm9qZWN0O1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlclByb2plY3QoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgICByZW5kZXJDb250ZW50KCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgJ1BST0pFQ1RTJztcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0KCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGApISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgICAgIC8vY2xlYXIgdGhlIG5vZGUgYmVmb3JlIHJlLXJlbmRlcmluZ1xyXG4gICAgICAgIGxpc3RFbC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBmb3IgKGNvbnN0IHByakl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKSB7XHJcbiAgICAgICAgICAgIG5ldyBQcm9qZWN0SXRlbShsaXN0RWwuaWQsIHByakl0ZW0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9ICBcclxufVxyXG5cclxuIiwiaW1wb3J0IHtQcm9qZWN0SW5wdXR9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWlucHV0JztcclxuaW1wb3J0IHtQcm9qZWN0TGlzdH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdCc7XHJcblxyXG5cclxubmV3IFByb2plY3RJbnB1dCgpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7XHJcblxyXG4iXSwibmFtZXMiOlsiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0aGlzIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEF0QmVnaW5uaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiQXV0b2JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmxlSW5wdXQiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ0b1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW4iLCJtYXgiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJQcm9qZWN0U3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyRm4iLCJwdXNoIiwic3VwZXIiLCJwcm9qZWN0cyIsImluc3RhbmNlIiwiYWRkUHJvamVjdCIsIm51bU9mUGVvcGxlIiwibmV3UHJvamVjdCIsIk1hdGgiLCJyYW5kb20iLCJBY2l0dmUiLCJ1cGRhdGVMaXN0ZW5lcnMiLCJtb3ZlUHJvamVjdCIsInByaklkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwcmoiLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwiUHJvamVjdElucHV0IiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJhZGRFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsInJlbmRlckNvbnRlbnQiLCJnYXRoZXJVc2VySW5wdXQiLCJlbnRlcmVkVGl0bGUiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInN1YnN0cmluZyIsImVudGVyZWREZXNjcmlwdGlvbiIsImVudGVyZWRQZW9wbGUiLCJkZXNjcmlwdGlvblZhbGlkYXRhYmxlIiwicGVvcGxlVmFsaWRhdGFibGUiLCJhbGVydCIsImNsZWFySW5wdXRzIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsImRlc2MiLCJQcm9qZWN0SXRlbSIsImhvc3RJZCIsImRyYWdTdGFydEhhbmRsZXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwiY29uc29sZSIsImxvZyIsInRleHRDb250ZW50IiwicGVyc29ucyIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsImNsYXNzTGlzdCIsImFkZCIsImRyb3BIYW5kbGVyIiwiZ2V0RGF0YSIsIkZpbmlzaGVkIiwiZHJhZ0xlYXZlSGFuZGxlciIsImxpc3RFbCIsInJlbW92ZSIsInJlbGV2YW50UHJvamVjdCIsImZpbHRlciIsInByb2oiLCJyZW5kZXJQcm9qZWN0IiwibGlzdElkIiwiaW5uZXJIVE1MIiwicHJqSXRlbSJdLCJzb3VyY2VSb290IjoiIn0=